# Conversation and CRM Summary Tool

## Overview

**Conversation and CRM Summary Tool** is a modular, LangGraph-powered system designed to process, consolidate, and summarize multi-channel student-agent conversations (calls, WhatsApp, email, CRM, etc.) into structured, actionable summaries for Amber agents. The system supports incremental, on-demand summarization, with each summary section handled by a dedicated node.

---

## Architecture

```mermaid
graph TD
    A[Raw Data (Calls, WhatsApp, Email, CRM, ...)] --> B[Data Loader]
    B --> C[Data Consolidator]
    C --> D[Unified Timeline]
    D --> E1[StudentCardNode]
    D --> E2[LeadStatusNode]
    D --> E3[StudentRequirementsNode]
    D --> E4[AdmissionJourneyNode]
    D --> E5[PropertyPreferencesNode]
    D --> E6[ConversationSummaryNode]
    D --> E7[ActionablesNode]
    D --> E8[TasksAndNextStepsNode]
    E1 --> F[Summary Store]
    E2 --> F
    E3 --> F
    E4 --> F
    E5 --> F
    E6 --> F
    E7 --> F
    E8 --> F
```

- **Data Loader:** Loads all relevant files for a lead, regardless of naming convention.
- **Data Consolidator:** Merges all events into a single, chronologically ordered timeline, sessionizes WhatsApp, and normalizes event types.
- **Nodes:** Each node extracts a specific summary section from the timeline using LLMs.
- **Summary Store:** Stores structured summaries per lead for incremental and on-demand access.

---

## Key Features
- Multi-channel data consolidation (calls, WhatsApp, email, CRM, ...)
- Modular, node-based summarization (easy to extend)
- Incremental and on-demand summary generation
- LLM-friendly preprocessing for high-quality outputs
- Robust error handling and debug logging
- Secure handling of secrets and environment variables

---

## Directory Structure

```
Langraph testing/
├── app.py
├── consolidated_counts.json
├── consolidated_llm_timeline.json
├── consolidated_llm_text.txt
├── consolidated_timeline.json
├── data/
│   └── Lead001/
│       ├── call_001.txt
│       ├── lead_test001.json
│       ├── mail_test001.json
│       ├── summary_store.json
│       └── Whatsapp_test001.json
├── graph/
│   ├── data_consolidator.py
│   ├── data_loader.py
│   └── summary_store.py
├── nodes/
│   ├── actionables.py
│   ├── admission_journey.py
│   ├── conversation_summary.py
│   ├── conversation_timeline.py
│   ├── lead_status.py
│   ├── property_preferences.py
│   ├── student_card.py
│   ├── student_requirements.py
│   └── tasks_and_next_steps.py
├── prompts/
├── README.md
├── requirements.txt
└── venv/
```

---

## Setup & Installation

1. **Clone the repository:**
   ```sh
   git clone https://github.com/Wakdeprathamesh-amber/Conversation-and-CRM-Summary-Tool.git
   cd Conversation-and-CRM-Summary-Tool
   ```
2. **Create and activate a virtual environment:**
   ```sh
   python3 -m venv venv
   source venv/bin/activate
   ```
3. **Install dependencies:**
   ```sh
   pip install -r requirements.txt
   ```
4. **Set up your `.env` file:**
   - Copy `.env.example` to `.env` (if provided) or create a `.env` file with your OpenAI API key:
     ```env
     OPENAI_API_KEY=sk-...
     ```
   - **Never commit your `.env` file to git!**

---

## Usage

- Run the main app:
  ```sh
  python app.py
  ```
- Summaries and timelines will be generated and saved in the project root for inspection.
- To process a different lead, update the data in the `data/` directory and rerun.

---

# Frontend (Agent UI)

## Features
- **Modern React + Vite + Tailwind UI** for agent workflow
- **Conversation Summary**: Beautiful, collapsible markdown summary generated by LLM
- **Requirements & Tasks**: Structured, readable cards for requirements and actionables
- **Transcription**: Transcribe individual calls or all calls at once, with progress and error handling
- **Save/Export**: Download summary, requirements, or tasks as PDF or JSON
- **Responsive and agent-friendly**: Designed for clarity and speed

## Setup & Installation

1. **Navigate to the frontend directory:**
   ```sh
   cd project
   ```
2. **Install dependencies:**
   ```sh
   npm install
   ```
3. **Start the development server:**
   ```sh
   npm run dev
   ```
   The app will be available at `http://localhost:5173` (or as shown in your terminal).

## Main UI Workflow

- **Timeline View**: Shows all events (calls, WhatsApp, emails, etc.) for a lead.
- **Transcribe All Calls**: Click "Transcribe all calls" to batch transcribe all call recordings. Progress and errors are shown. Transcripts appear in each call's details.
- **Generate Summary**: Click "Generate Summary" to run the LLM pipeline and view the conversation summary, requirements, and tasks.
- **Save/Export**: Each section (summary, requirements, tasks) has buttons to save as PDF or JSON for easy sharing or record-keeping.

## File Structure (Frontend)

```
project/
├── package.json
├── src/
│   ├── App.tsx
│   ├── main.tsx
│   ├── index.css
│   ├── components/
│   │   ├── timeline/
│   │   │   ├── TimelineSection.tsx
│   │   │   └── TimelineItem.tsx
│   │   └── summary/
│   │       ├── LLMSummaryDisplay.tsx
│   │       └── LLMStructuredDisplay.tsx
│   └── ...
├── public/
└── ...
```

## Key Components
- **TimelineSection.tsx**: Main timeline and action panel (transcribe, generate summary)
- **TimelineItem.tsx**: Renders each event (call, WhatsApp, email, etc.)
- **LLMSummaryDisplay.tsx**: Shows the LLM-generated conversation summary and export buttons
- **LLMStructuredDisplay.tsx**: Shows requirements and tasks/actionables in a structured, agent-friendly format

## Transcription API
- The frontend expects a backend endpoint at `http://localhost:8001/transcribe-call` for transcription.
- Each call item is POSTed as `{ record_url, mobile_number, call_id }` and expects a plain text transcript in response.

## Customization & Extensibility
- Add new UI panels or export options as needed
- Integrate with CRM or other systems by extending the backend endpoints
- Style with Tailwind for rapid UI changes

---

## Adding New Nodes or Channels

- **To add a new summary node:**
  1. Create a new file in `nodes/` (e.g., `my_new_node.py`).
  2. Implement a class with a `process` method that takes the timeline as input and returns a structured summary.
  3. Register and call the node in `app.py`.
- **To add a new data channel:**
  1. Update `data_loader.py` and `data_consolidator.py` to recognize and merge the new channel's data.
  2. Ensure the timeline includes events from the new channel in chronological order.

---



